import{r as s,c as t,h as e}from"./p-ee0b9025.js";import{S as i}from"./p-c74b54ba.js";import{a}from"./p-a3e4386d.js";import{m as l}from"./p-971980b1.js";import"./p-82db2ff5.js";import"./p-949334ec.js";import{m as n}from"./p-1b40b0d1.js";import{T as o}from"./p-37df3757.js";import{i as r,I as h}from"./p-76935ab4.js";import{t as d,e as c,l as p}from"./p-fd4270fe.js";import"./p-4745c03b.js";import"./p-a3b5bd35.js";import"./p-80de33dc.js";import"./p-93cac3a6.js";import"./p-d88cb309.js";import"./p-83f217d4.js";let u=class{constructor(e){s(this,e),this.expressionChanged=t(this,"expressionChanged",7),this.opensModal=!1,this.editorHeight="6em",this.singleLineMode=!1,this.onEditorClick=e=>{e.preventDefault(),n.show(this.language,this.currentExpression,(e=>this.setExpression(e)))}}expressionChangedHandler(e){this.currentExpression=e}async setExpression(e){await this.monacoEditor.setValue(e)}async componentWillLoad(){this.currentExpression=this.expression}async componentDidLoad(){const e=await a(this.serverUrl),t=await e.scriptingApi.getJavaScriptTypeDefinitions(this.workflowDefinitionId,this.context),s="defaultLib:lib.es6.d.ts";await this.monacoEditor.addJavaScriptLib(t,s),n.monacoEditor&&n.monacoEditor.addJavaScriptLib(t,s)}async onMonacoValueChanged(e){this.currentExpression=e.value,await this.expressionChanged.emit(e.value)}render(){return e("elsa-monaco",{value:this.currentExpression,language:this.language,"editor-height":this.editorHeight,"single-line":this.singleLineMode,padding:this.padding,onValueChanged:e=>this.onMonacoValueChanged(e.detail),ref:e=>this.monacoEditor=e},this.opensModal&&e("button",{class:"elsa-absolute elsa-z-10",style:{left:"0.25rem",top:"0.35rem"},onClick:this.onEditorClick},r.getIcon(h.OpenInDialog)))}static get watchers(){return{expression:["expressionChangedHandler"]}}};o.injectProps(u,["serverUrl","workflowDefinitionId"]);let m=class{constructor(e){s(this,e),this.syntaxChanged=t(this,"syntaxChanged",7),this.expressionChanged=t(this,"expressionChanged",7),this.defaultSyntax=i.Literal,this.expressions={},this.supportedSyntaxes=[],this.editorHeight="10em",this.singleLineMode=!1}async componentWillLoad(){this.selectedSyntax=this.syntax,this.currentValue=this.expressions[this.selectedSyntax?this.selectedSyntax:this.defaultSyntax]}onWindowClicked(e){this.contextMenuWidget&&this.contextMenuWidget.contains(e.target)||this.closeContextMenu()}toggleContextMenu(){d(this.contextMenu)}openContextMenu(){c(this.contextMenu)}closeContextMenu(){this.contextMenu&&p(this.contextMenu)}selectDefaultEditor(e){e.preventDefault(),this.selectedSyntax=void 0,this.closeContextMenu()}async selectSyntax(e,t){e.preventDefault(),this.selectedSyntax=t,this.syntaxChanged.emit(t),this.currentValue=this.expressions[t||this.defaultSyntax||i.Literal],this.currentValue&&await this.expressionEditor.setExpression(this.currentValue),this.closeContextMenu()}onSettingsClick(e){this.toggleContextMenu()}onExpressionChanged(e){const t=e.detail;t&&(this.expressions[this.selectedSyntax||this.defaultSyntax]=t,this.expressionChanged.emit(t))}render(){return e("div",null,e("div",{class:"elsa-mb-1"},e("div",{class:"elsa-flex"},e("div",{class:"elsa-flex-1"},this.renderLabel()),this.renderContextMenuWidget())),this.renderEditor())}renderLabel(){if(!this.label)return;const t=this.fieldName;return e("label",{htmlFor:t,class:"elsa-block elsa-text-sm elsa-font-medium elsa-text-gray-700"},this.label||t)}renderContextMenuWidget(){if(0==this.supportedSyntaxes.length)return;const t=this.selectedSyntax;return e("div",{class:"elsa-relative",ref:e=>this.contextMenuWidget=e},e("button",{type:"button",class:"elsa-border-0 focus:elsa-outline-none elsa-text-sm "+(t?"elsa-text-blue-500":"elsa-text-gray-300"),onClick:e=>this.onSettingsClick(e)},this.isReadOnly?"":this.renderContextMenuButton()),e("div",null,e("div",{ref:e=>this.contextMenu=e,"data-transition-enter":"elsa-transition elsa-ease-out elsa-duration-100","data-transition-enter-start":"elsa-transform elsa-opacity-0 elsa-scale-95","data-transition-enter-end":"elsa-transform elsa-opacity-100 elsa-scale-100","data-transition-leave":"elsa-transition elsa-ease-in elsa-duration-75","data-transition-leave-start":"elsa-transform elsa-opacity-100 elsa-scale-100","data-transition-leave-end":"elsa-transform elsa-opacity-0 elsa-scale-95",class:"hidden elsa-origin-top-right elsa-absolute elsa-right-1 elsa-mt-1 elsa-w-56 elsa-rounded-md elsa-shadow-lg elsa-bg-white elsa-ring-1 elsa-ring-black elsa-ring-opacity-5 elsa-divide-y elsa-divide-gray-100 focus:elsa-outline-none elsa-z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu"},e("div",{class:"elsa-py-1",role:"none"},e("a",{onClick:e=>this.selectSyntax(e,null),href:"#",class:"elsa-block elsa-px-4 elsa-py-2 elsa-text-sm hover:elsa-bg-gray-100 hover:elsa-text-gray-900 "+(t?"elsa-text-gray-700":"elsa-text-blue-700"),role:"menuitem"},"Default")),e("div",{class:"elsa-py-1",role:"none"},this.supportedSyntaxes.map((s=>e("a",{onClick:e=>this.selectSyntax(e,s),href:"#",class:"elsa-block elsa-px-4 elsa-py-2 elsa-text-sm hover:elsa-bg-gray-100 hover:elsa-text-gray-900 "+(t==s?"elsa-text-blue-700":"elsa-text-gray-700"),role:"menuitem"},s)))))))}renderContextMenuButton(){return this.selectedSyntax?e("span",null,this.selectedSyntax):e("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-400",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},e("path",{stroke:"none",d:"M0 0h24v24H0z"}),e("circle",{cx:"12",cy:"12",r:"9"}),e("line",{x1:"8",y1:"12",x2:"8",y2:"12.01"}),e("line",{x1:"12",y1:"12",x2:"12",y2:"12.01"}),e("line",{x1:"16",y1:"12",x2:"16",y2:"12.01"}))}renderEditor(){const t=this.selectedSyntax,s=l(t),i=t?"hidden":"block";return e("div",null,e("div",{class:t?"block":"hidden"},e("elsa-expression-editor",{ref:e=>this.expressionEditor=e,onExpressionChanged:e=>this.onExpressionChanged(e),expression:this.currentValue,language:s,editorHeight:this.editorHeight,singleLineMode:this.singleLineMode,context:this.context,opensModal:!0})),e("div",{class:i},e("slot",null)))}},x=class{constructor(e){s(this,e),this.defaultSyntaxValueChanged=t(this,"defaultSyntaxValueChanged",7),this.editorHeight="10em",this.singleLineMode=!1,this.showLabel=!0}onSyntaxChanged(e){this.propertyModel.syntax=e.detail}onExpressionChanged(e){const t=this.propertyDescriptor.defaultSyntax||i.Literal,s=this.propertyModel.syntax||t;this.propertyModel.expressions[s]=e.detail,s==t&&this.defaultSyntaxValueChanged.emit(e.detail)}render(){const t=this.propertyDescriptor,s=this.propertyModel,i=t.hint;return e("div",null,e("elsa-multi-expression-editor",{onSyntaxChanged:e=>this.onSyntaxChanged(e),onExpressionChanged:e=>this.onExpressionChanged(e),fieldName:t.name,label:this.showLabel?t.label:null,syntax:s.syntax,defaultSyntax:t.defaultSyntax,isReadOnly:t.isReadOnly,expressions:s.expressions,supportedSyntaxes:t.supportedSyntaxes,"editor-height":this.editorHeight,context:{propertyName:t.name,activityTypeName:this.activityModel.type}},e("slot",null)),i?e("p",{class:"elsa-mt-2 elsa-text-sm elsa-text-gray-500"},i):void 0)}};x.style="";export{u as elsa_expression_editor,m as elsa_multi_expression_editor,x as elsa_property_editor};